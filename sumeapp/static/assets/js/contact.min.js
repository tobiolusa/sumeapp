/*-----------------------------------------------------------------------------------
    Template Name: Getlinked
    Template URI: https://github.com/theolawalemi
    Description: Igniting a revolution in HR innovation.
    Author: Olwalemi
    Author URI: https://github.com/theolawalemi
    Version: 1.0
-----------------------------------------------------------------------------------*/
// API Connection
const contactForm = document.getElementById("contactForm");
const alertWrapper = document.getElementById("alert-message");

function submitContactForm(e) {
    e.preventDefault();
    const formData = new FormData(contactForm);
    const requestBody = {
        first_name: formData.get("first_name"),
        email: formData.get("email"),
        message: formData.get("message"),
    };
    const jsonData = JSON.stringify(requestBody);
    const url = "https://backend.getlinked.ai/hackathon/contact-form";
    fetch(url, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: jsonData,
    })
    .then((response) => {
        if (!response.ok) {
            throw new Error("Something went wrong.");
        }
        return response.json();
    })
    .then(() => {
        showSuccess("Message sent successfully.");
    })
    .catch((error) => {
        showError("Something went wrong.");
    });
}
function showMessage(message, className) {
    alertWrapper.innerHTML = `<div class="${className}">${message}</div>`;
}
function showError(message) {
    showMessage(message, "alertError");
}
function showSuccess(message) {
    showMessage(message, "alertSuccess");
}
contactForm.addEventListener("submit", submitContactForm);

// Navbar background
const toggler = document.querySelector(".navbar-toggler");
const navbar = document.querySelector(".navbar");
const [navbarOpen, navbarClose] = document.querySelectorAll(".navbar-open, .navbar-close");
navbarClose.style.display = "none";
toggler.addEventListener("click", () => {
    navbar.classList.toggle("navbar-bg");
    navbarOpen.style.display = navbarOpen.style.display === "none" ? "inline-block" : "none";
    navbarClose.style.display = navbarClose.style.display === "none" ? "inline-block" : "none";
});
  
// Hero section animation
gsap.registerPlugin('random');

gsap.from(".header .navbar-brand", {
    duration: 1,
    opacity: 0,
    y: () => gsap.utils.random(-50, 50),
    ease: "power2.inOut"
});
gsap.from(".header .nav-link", {
    duration: 1,
    opacity: 0,
    x: -100,
    ease: "power2.inOut",
    stagger: {
        each: 0.25,
        from: "start"
    }
});
gsap.from(".header .btn-navbar", {
    duration: 1,
    opacity: 0,
    x: 50,
    ease: "power2.inOut",
}, "<");

// Contact section animation
gsap.from(".contact-section .contact-form", {
    duration: 1.5,
    opacity: 0,
    x: () => gsap.utils.random(-50, 50),
    ease: "power2.inOut"
});
gsap.from(".contact-section .section-heading, .contact-section .contact-stagger", {
    duration: 1,
    opacity: 0,
    y: 50,
    stagger: 0.2,
    ease: "power2.inOut"
}, "<");

// All stars blinking animation
const stars = document.querySelectorAll('.stars');
const blinks = (star) => {
    return gsap.fromTo(star, { opacity: 1 },
        {
            opacity: 0,
            duration: 0.2,
            repeat: -1,
            yoyo: true,
        }
    );
};
const staggerStars = () => {
    stars.forEach((star, index) => {
        gsap.fromTo(star, { opacity: 0 },
            {
                opacity: 1,
                duration: 0.5,
                ease: 'back.out',
                delay: 1 + index * 1,
                onComplete: () => {
                    blinks(star);
                },
            }
        );
    });
};
staggerStars();

// Footer section animation
const footerStar = document.querySelectorAll('.footer-star');
const blinkx = (star) => {
    return gsap.fromTo(star, { opacity: 1 },
        {
            opacity: 0,
            duration: 0.2,
            repeat: -1,
            yoyo: true,
        }
    );
};
const footerStaggerStar = () => {
    footerStar.forEach((star, index) => {
        gsap.fromTo(star, { opacity: 0 },
            {
                opacity: 1,
                duration: 0.5,
                ease: 'back.out',
                delay: 1 + index * 1,
                onComplete: () => {
                    blinkx(star);
                },
            }
        );
    });
};
footerStaggerStar();

// Particles animation
const pop = (e) => {
    const amount = 10;
    const x = e.clientX;
    const y = e.clientY;

    for (let i = 0; i < amount; i++) {
        createParticle(x, y);
    }
};

const createParticle = (x, y) => {
    const particle = document.createElement("div");
    particle.className = "particle";
    document.body.appendChild(particle);

    // Replace with your SVG path
    particle.style.backgroundImage = "url('assets/images/svg/star-white.svg')";
    particle.style.backgroundSize = 'contain';
    particle.style.backgroundRepeat = 'no-repeat';

    const size = Math.floor(Math.random() * 32 + 8); // Adjust size range
    particle.style.width = `${size}px`;
    particle.style.height = `${size}px`;

    const destinationX = x + (Math.random() - 0.5) * 500;
    const destinationY = y + (Math.random() - 0.5) * 500;

    const rotation = Math.random() * 500;
    const delay = Math.random() * 200;

    gsap.fromTo(
        particle,
        {
            x,
            y,
            rotation: 0,
            opacity: 1,
        },
        {
            x: destinationX,
            y: destinationY,
            rotation,
            opacity: 0,
            duration: Math.random() * 4 + 1, // Random duration between 1 and 5 seconds
            ease: 'power4.out',
            delay: delay / 1000, // Convert delay to seconds
            onComplete: () => particle.remove(),
        }
    );
};

if (document.body.animate) {
    document.body.addEventListener('click', pop);
}

// Cursor animation
const cursor = document.getElementById("cursor");
const cursorEffect = (e) => {
    cursor.style.top = `${e.clientY}px`;
    cursor.style.left = `${e.clientX}px`;
    const element = document.createElement("div");
    element.className = "element";
    document.body.prepend(element);
    element.style.left = `${e.pageX}px`;
    element.style.top = `${e.pageY - 10}px`;
    setTimeout(() => {
        const text = document.querySelectorAll(".element")[0];
        const directionX = Math.random() < 0.5 ? -1 : 1;
        const directionY = Math.random() < 0.5 ? -1 : 1;
        text.style.left = `${parseInt(text.style.left) - directionX * (Math.random() * 200)}px`;
        text.style.top = `${parseInt(text.style.left) - directionY * (Math.random() * 200)}px`;
        text.style.opacity = 0;
        text.style.transform = "scale(0.25)";
        text.innerHTML = randomText();
    }, 10);
    setTimeout(() => {
        element.remove();
    }, 1000);
};
const randomText = () => {
    const text = "oocooocococococ".split("");
    const letter = text[Math.floor(Math.random() * text.length)];
    return letter;
};
document.addEventListener("mousemove", cursorEffect);

// Pointer animation
const pointer = document.getElementById("pointer");
const isCursor = (event) => {
    gsap.to(pointer, {
        duration: 0.2,
        x: event.clientX,
        y: event.clientY,
        ease: "power2.out"
    });
};
window.addEventListener("mousemove", isCursor);
Array.from(document.querySelectorAll(".hover")).forEach(el => {
    el.addEventListener('mouseover', (event) => {
        cursor.style.display = "none";
        event.stopPropagation();
        gsap.to(pointer, {
            duration: 0.2,
            scale: 5,
            backgroundColor: "#ffffff",
            mixBlendMode: "difference",
            ease: "power2.out"
        });
    });
    el.addEventListener('mouseleave', (event) => {
        cursor.style.display = "block";
        event.stopPropagation();
        gsap.to(pointer, {
            duration: 0.2,
            scale: 0,
            ease: "power2.out"
        });
    });
});

console.clear();
console.log.apply(console, [
    "%c Developed by Olawalemi %c %cðŸ‘Œ %c",
    "color: #fff; background: #0d60d8; padding: 5px 0;",
    "color: #fff; background: #0c1825; padding: 5px 0 5px 5px;",
    "background: #0c1825; padding: 5px 0",
    "background: #0c1825; padding: 5px 5px 5px 0",
]);